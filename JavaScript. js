// Load data when page opens
window.onload = function() {
    displayStudents();
};

function generateProfile() {
    const name = document.getElementById('name').value;
    const roll = document.getElementById('roll').value;
    const dept = document.getElementById('dept').value;
    const attendance = parseFloat(document.getElementById('attendance').value);

    if(!name || !roll || isNaN(attendance)) {
        alert("Please fill all fields");
        return;
    }

    // 1. Calculate Status
    let status = attendance >= 90 ? "GOOD" : (attendance >= 80 ? "AVG" : "DANGER");
    
    // 2. Calculate Marks
    let marks = 0;
    if (attendance >= 95) marks = 5;
    else if (attendance >= 85) marks = 4;
    else if (attendance >= 75) marks = 3;
    else if (attendance >= 65) marks = 2;
    else if (attendance >= 60) marks = 1;

    // 3. Create Student Object
    const student = { name, roll, dept, attendance, status, marks };

    // 4. Save to Local Storage
    let students = JSON.parse(localStorage.getItem('students')) || [];
    students.push(student);
    localStorage.setItem('students', JSON.stringify(students));

    // 5. Refresh Table and Show Profile
    displayStudents();
    alert("Student Data Saved!");
}

function displayStudents() {
    const students = JSON.parse(localStorage.getItem('students')) || [];
    const tableBody = document.getElementById('tableBody');
    tableBody.innerHTML = "";

    students.forEach(s => {
        let rowColor = s.status === "DANGER" ? "#ffcccc" : (s.status === "GOOD" ? "#ccffcc" : "#fff3cd");
        tableBody.innerHTML += `
            <tr style="background-color: ${rowColor}">
                <td>${s.roll}</td>
                <td>${s.name}</td>
                <td>${s.dept}</td>
                <td>${s.attendance}%</td>
                <td><strong>${s.status}</strong></td>
                <td>${s.marks}m</td>
            </tr>
        `;
    });
}

function clearData() {
    if(confirm("Delete all records?")) {
        localStorage.clear();
        displayStudents();
    }
}
    document.getElementById('display-roll').innerText = roll;
    document.getElementById('display-dept').innerText = dept;
    
    const badge = document.getElementById('status-badge');
    badge.innerText = status;
    badge.style.backgroundColor = color;
    
    document.getElementById('display-marks').innerText = marks + "m";
}
